<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="$langISO">
  <head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=11" />
    <meta name="generator" content="Doxygen 1.9.1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="icon" type="image/x-icon" href="favicon.svg">
    <title>RIOT OS: LTC4150 coulomb counter</title>
    <!--BEGIN PROJECT_ICON-->
    <link rel="icon" href="$projecticon" type="image/x-icon" />
    <!--END PROJECT_ICON-->
    <link href="tabs.css" rel="stylesheet" type="text/css" />
    <script type="text/javascript" src="jquery.js"></script>
    <script type="text/javascript" src="dynsections.js"></script>
    <!--BEGIN COPY_CLIPBOARD-->
    <script type="text/javascript" src="clipboard.js"></script>
    <!--END COPY_CLIPBOARD-->
    <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
    <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
    $darkmode
    <link href="doxygen.css" rel="stylesheet" type="text/css" />
    <link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="global.css" rel="stylesheet" type="text/css"/>
    <!-- ... other metadata & script includes ... -->
    <script
      type="text/javascript"
      src="doxygen-awesome-paragraph-link.js"
    ></script>
      <script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
    <!-- <link href="pagefind/pagefind-ui.css" rel="stylesheet"> -->
    <script src="pagefind/pagefind-ui.js"></script>
    <script>
      // Check whether the PagefindUI class is available
      if (typeof PagefindUI === "undefined") {
        console.warn("PagefindUI class is not available | Dev Build");
      } else {
        // // Remove the "searchstub" element and initialize the PagefindUI class
        // document.getElementById("#searchstub").remove();
        // Initialize the PagefindUI class with the element id "search"
        window.addEventListener("DOMContentLoaded", (event) => {
          new PagefindUI({
            element: "#pagefindsearch",
            showSubResults: true,
            showImages: false,
            resetStyles: false,
            mergeFilter: {
              "Information Source": "API Documentation",
            },
            mergeIndex: [{
              bundlePath: "https://riot.annsann.eu/pagefind",
              mergeFilter: {
                "Information Source": "Guides",
              }
          }], 
          });
        });
      }
    </script>
    <script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
  </head>
  <body>
    <div>
        <script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
        <script type="text/javascript">
            DoxygenAwesomeDarkModeToggle.init()
        </script>
          <div id="titlearea">
            <table cellspacing="0" cellpadding="0">
              <tbody>
                <tr id="projectrow">
                  <td id="projectlogo">
                    <img alt="Logo" src="riot-logo.svg" $logosize />
                  </td>
                  <td id="projectalign">
                    <div id="projectname">
                      RIOT OS
                    </div>
                    <div id="projectbrief">The friendly OS for the IoT</div>
                  </td>
                </tr>
                <!--BEGIN FULL_SIDEBAR-->
                <tr>
                  <td colspan="2">        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
                </tr>
                <!--END FULL_SIDEBAR-->
              </tbody>
            </table>
            <div
              id="searchbox"
              class="searchboxui"
            >
                <button
                id="enable-search-box"
                class="searchbutton"
                >
                <h3>üê∏üîé</h3>
                <h4>Search</h4>
              </button>
              <div id="pagefindsearch" class="hidden"></div>
            </div>
          </div>
        </div>
        <script>
          /* When the user clicks on the button, toggle between hiding and showing the search box content */
          document.getElementById("enable-search-box").addEventListener("click", function () {
            var searchbox = document.getElementById("pagefindsearch");
            if (searchbox.classList.contains("hidden")) {
              searchbox.classList.remove("hidden");
              /* Focus on the search input field (classname pagefind-ui__search-input) */
              searchbox.querySelector(".pagefind-ui__search-input").focus();
            } else {
              searchbox.classList.add("hidden");
            }
          });
        </script>
        <!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('group__drivers__ltc4150.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#files">Files</a> &#124;
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">LTC4150 coulomb counter<div class="ingroups"><a class="el" href="group__drivers.html">Drivers</a> &raquo; <a class="el" href="group__drivers__sensors.html">Sensor Device Drivers</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Driver for the Linear Tech LTC4150 Coulomb Counter (a.k.a. </p>
<p>battery gauge sensor or power consumption sensor)</p>
<h1><a class="anchor" id="autotoc_md1679"></a>
Wiring the LTC4150</h1>
<p>Hint: M Grusin thankfully created an <a href="https://cdn.sparkfun.com/datasheets/BreakoutBoards/LTC4150_BOB_v10.pdf">open hardware breakout board</a>. As a result, virtually all LTC4150 breakout boards are using this schematic. Whenever this documentation refers to a breakout board, this open hardware board is meant. Of course, this driver works with the "bare" LTC4150 as well.</p>
<p>Please note that this driver works interrupt driven and does not clear the signal. Thus, the /CLR and /INT pins on the LTC4150 need to be connected (in case of the breakout board: close solder jumper SJ1), so that the signal is automatically cleared.</p>
<p>Hint: The breakout board uses external pull up resistors on /INT, POL and /SHDN. Therefore /SHDN can be left unconnected and no internal pull ups are required for /INT and POL. In case your board uses 3.3V logic the solder jumpers SJ2 and SJ3 have to be closed, in case of 5V they have to remain open. Connect the VIO pin to the logic level, GND to ground, IN+ and IN- to the power supply and use OUT+ and OUT- to power your board.</p>
<p>In the easiest case only the /INT pin needs to be connected to a GPIO, and (in case of external pull ups) /SHDN and POL can be left unconnected. The GPIO /INT is connected to support for interrupts, /SHDN and POL (if connected) do not require interrupt support.</p>
<p>In case a battery is used the POL pin connected to another GPIO. This allows to distinguish between charge drawn from the battery and charge transferred into the battery (used to load it).</p>
<p>In case support to power off the LTC4150 is desired, the /SHDN pin needs to be connected to a third GPIO.</p>
<h1><a class="anchor" id="autotoc_md1680"></a>
Things to keep in mind</h1>
<p>The LTC4150 creates pulses with a frequency depending on the current drawn. Thus, more interrupts need to be handled when more current is drawn, which in turn increases system load (and power consumption). The interrupt service routing is quite short and even when used outside of specification less than 20 ticks per second will occur. Hence, this effect should hopefully be negligible. </p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="files"></a>
Files</h2></td></tr>
<tr class="memitem:ltc4150_8h"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ltc4150_8h.html">ltc4150.h</a></td></tr>
<tr class="memdesc:ltc4150_8h"><td class="mdescLeft">&#160;</td><td class="mdescRight">LTC4150 coulomb counter. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ltc4150__params_8h"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ltc4150__params_8h.html">ltc4150_params.h</a></td></tr>
<tr class="memdesc:ltc4150__params_8h"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default configuration for LTC4150 coulomb counters. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structltc4150__recorder__t.html">ltc4150_recorder_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interface to allow recording of the drawn current in a user defined resolution.  <a href="structltc4150__recorder__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structltc4150__params__t.html">ltc4150_params_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parameters required to set up the LTC4150 coulomb counter.  <a href="structltc4150__params__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structltc4150__dev.html">ltc4150_dev</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">LTC4150 coulomb counter.  <a href="structltc4150__dev.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structltc4150__last__minute__data__t.html">ltc4150_last_minute_data_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Data structure used by <a class="el" href="group__drivers__ltc4150.html#ga2a4b5144157383f5a4ab76251130ec29">ltc4150_last_minute</a>.  <a href="structltc4150__last__minute__data__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:gacea050c124a43ee9deeb487b231381b6"><td class="memItemLeft" align="right" valign="top"><a id="gacea050c124a43ee9deeb487b231381b6"></a>
typedef struct <a class="el" href="structltc4150__dev.html">ltc4150_dev</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__drivers__ltc4150.html#gacea050c124a43ee9deeb487b231381b6">ltc4150_dev_t</a></td></tr>
<tr class="memdesc:gacea050c124a43ee9deeb487b231381b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">LTC4150 coulomb counter. <br /></td></tr>
<tr class="separator:gacea050c124a43ee9deeb487b231381b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:ga4eeeead548222804e141df8f1b205ca8"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom">{ <a class="el" href="group__drivers__ltc4150.html#gga4eeeead548222804e141df8f1b205ca8ac5c149c6fcf7ca08031e4c94d1da9c30">LTC4150_INT_EXT_PULL_UP</a> = 0x01
, <a class="el" href="group__drivers__ltc4150.html#gga4eeeead548222804e141df8f1b205ca8a3894eb1352bfe95e8d7df8a0dc6a2c35">LTC4150_POL_EXT_PULL_UP</a> = 0x02
, <a class="el" href="group__drivers__ltc4150.html#gga4eeeead548222804e141df8f1b205ca8a2cca2783809788c4b5254012d78a5e80">LTC4150_EXT_PULL_UP</a> = LTC4150_INT_EXT_PULL_UP | LTC4150_POL_EXT_PULL_UP
 }</td></tr>
<tr class="memdesc:ga4eeeead548222804e141df8f1b205ca8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configuration flags of the LTC4150 coulomb counter.  <a href="group__drivers__ltc4150.html#ga4eeeead548222804e141df8f1b205ca8">More...</a><br /></td></tr>
<tr class="separator:ga4eeeead548222804e141df8f1b205ca8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8838cbe7f55e7f6946f74c100a10a8af"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__drivers__ltc4150.html#ga8838cbe7f55e7f6946f74c100a10a8af">ltc4150_dir_t</a> { <a class="el" href="group__drivers__ltc4150.html#gga8838cbe7f55e7f6946f74c100a10a8afa1ec59ceb1167d2f42dc0c0b0ec188b64">LTC4150_CHARGE</a>
, <a class="el" href="group__drivers__ltc4150.html#gga8838cbe7f55e7f6946f74c100a10a8afa6bd7dd6cf179c3075989e7f6bf0e6078">LTC4150_DISCHARGE</a>
 }</td></tr>
<tr class="memdesc:ga8838cbe7f55e7f6946f74c100a10a8af"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enumeration of directions in which the charge can be transferred.  <a href="group__drivers__ltc4150.html#ga8838cbe7f55e7f6946f74c100a10a8af">More...</a><br /></td></tr>
<tr class="separator:ga8838cbe7f55e7f6946f74c100a10a8af"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga4fa850f74cbacdf35d41a0a111265d49"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__drivers__ltc4150.html#ga4fa850f74cbacdf35d41a0a111265d49">ltc4150_init</a> (<a class="el" href="group__drivers__ltc4150.html#gacea050c124a43ee9deeb487b231381b6">ltc4150_dev_t</a> *dev, const <a class="el" href="structltc4150__params__t.html">ltc4150_params_t</a> *params)</td></tr>
<tr class="memdesc:ga4fa850f74cbacdf35d41a0a111265d49"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the LTC4150 driver.  <a href="group__drivers__ltc4150.html#ga4fa850f74cbacdf35d41a0a111265d49">More...</a><br /></td></tr>
<tr class="separator:ga4fa850f74cbacdf35d41a0a111265d49"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1840c34b0f4bd05ffa9279b934189848"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__drivers__ltc4150.html#ga1840c34b0f4bd05ffa9279b934189848">ltc4150_reset_counters</a> (<a class="el" href="group__drivers__ltc4150.html#gacea050c124a43ee9deeb487b231381b6">ltc4150_dev_t</a> *dev)</td></tr>
<tr class="memdesc:ga1840c34b0f4bd05ffa9279b934189848"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clear current counters of the given LTC4150 device.  <a href="group__drivers__ltc4150.html#ga1840c34b0f4bd05ffa9279b934189848">More...</a><br /></td></tr>
<tr class="separator:ga1840c34b0f4bd05ffa9279b934189848"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2de1ec4e0b025996428b85484b45b683"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__drivers__ltc4150.html#ga2de1ec4e0b025996428b85484b45b683">ltc4150_shutdown</a> (<a class="el" href="group__drivers__ltc4150.html#gacea050c124a43ee9deeb487b231381b6">ltc4150_dev_t</a> *dev)</td></tr>
<tr class="memdesc:ga2de1ec4e0b025996428b85484b45b683"><td class="mdescLeft">&#160;</td><td class="mdescRight">Disable the interrupt handler and turn the chip off.  <a href="group__drivers__ltc4150.html#ga2de1ec4e0b025996428b85484b45b683">More...</a><br /></td></tr>
<tr class="separator:ga2de1ec4e0b025996428b85484b45b683"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga54b4a64e07c4fd49480c7220aaebb311"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__drivers__ltc4150.html#ga54b4a64e07c4fd49480c7220aaebb311">ltc4150_charge</a> (<a class="el" href="group__drivers__ltc4150.html#gacea050c124a43ee9deeb487b231381b6">ltc4150_dev_t</a> *dev, uint32_t *charged, uint32_t *discharged)</td></tr>
<tr class="memdesc:ga54b4a64e07c4fd49480c7220aaebb311"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the measured charge since boot or last reset in millicoulomb.  <a href="group__drivers__ltc4150.html#ga54b4a64e07c4fd49480c7220aaebb311">More...</a><br /></td></tr>
<tr class="separator:ga54b4a64e07c4fd49480c7220aaebb311"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7cf0e00f44778e6c55ee87cbeed87998"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__drivers__ltc4150.html#ga7cf0e00f44778e6c55ee87cbeed87998">ltc4150_avg_current</a> (<a class="el" href="group__drivers__ltc4150.html#gacea050c124a43ee9deeb487b231381b6">ltc4150_dev_t</a> *dev, int16_t *dest)</td></tr>
<tr class="memdesc:ga7cf0e00f44778e6c55ee87cbeed87998"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the average current drawn in E-01 milliampere.  <a href="group__drivers__ltc4150.html#ga7cf0e00f44778e6c55ee87cbeed87998">More...</a><br /></td></tr>
<tr class="separator:ga7cf0e00f44778e6c55ee87cbeed87998"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3ad8761da01fd64c8571aa49d58b5264"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__drivers__ltc4150.html#ga3ad8761da01fd64c8571aa49d58b5264">ltc4150_last_minute_charge</a> (<a class="el" href="group__drivers__ltc4150.html#gacea050c124a43ee9deeb487b231381b6">ltc4150_dev_t</a> *dev, <a class="el" href="structltc4150__last__minute__data__t.html">ltc4150_last_minute_data_t</a> *data, uint32_t *charged, uint32_t *discharged)</td></tr>
<tr class="memdesc:ga3ad8761da01fd64c8571aa49d58b5264"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the measured charge in the last minute.  <a href="group__drivers__ltc4150.html#ga3ad8761da01fd64c8571aa49d58b5264">More...</a><br /></td></tr>
<tr class="separator:ga3ad8761da01fd64c8571aa49d58b5264"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabacb8f10da53a90b9626d036e031d47c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__drivers__ltc4150.html#gabacb8f10da53a90b9626d036e031d47c">ltc4150_pulses2c</a> (const <a class="el" href="group__drivers__ltc4150.html#gacea050c124a43ee9deeb487b231381b6">ltc4150_dev_t</a> *dev, uint32_t *charged, uint32_t *discharged, uint32_t raw_charged, uint32_t raw_discharged)</td></tr>
<tr class="memdesc:gabacb8f10da53a90b9626d036e031d47c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert the raw data (# pulses) acquired by the LTC4150 device to charge information in millicoulomb.  <a href="group__drivers__ltc4150.html#gabacb8f10da53a90b9626d036e031d47c">More...</a><br /></td></tr>
<tr class="separator:gabacb8f10da53a90b9626d036e031d47c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ga2a4b5144157383f5a4ab76251130ec29"><td class="memItemLeft" align="right" valign="top"><a id="ga2a4b5144157383f5a4ab76251130ec29"></a>
const <a class="el" href="structltc4150__recorder__t.html">ltc4150_recorder_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__drivers__ltc4150.html#ga2a4b5144157383f5a4ab76251130ec29">ltc4150_last_minute</a></td></tr>
<tr class="memdesc:ga2a4b5144157383f5a4ab76251130ec29"><td class="mdescLeft">&#160;</td><td class="mdescRight">Records the charge transferred within the last minute using. <br /></td></tr>
<tr class="separator:ga2a4b5144157383f5a4ab76251130ec29"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="ga4eeeead548222804e141df8f1b205ca8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4eeeead548222804e141df8f1b205ca8">&#9670;&nbsp;</a></span>anonymous enum</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Configuration flags of the LTC4150 coulomb counter. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="gga4eeeead548222804e141df8f1b205ca8ac5c149c6fcf7ca08031e4c94d1da9c30"></a>LTC4150_INT_EXT_PULL_UP&#160;</td><td class="fielddoc"><p>External pull on the /INT pin is present. </p>
</td></tr>
<tr><td class="fieldname"><a id="gga4eeeead548222804e141df8f1b205ca8a3894eb1352bfe95e8d7df8a0dc6a2c35"></a>LTC4150_POL_EXT_PULL_UP&#160;</td><td class="fielddoc"><p>External pull on the /POL pin is present. </p>
</td></tr>
<tr><td class="fieldname"><a id="gga4eeeead548222804e141df8f1b205ca8a2cca2783809788c4b5254012d78a5e80"></a>LTC4150_EXT_PULL_UP&#160;</td><td class="fielddoc"><p>External pull on the /INT <em>and</em> the /POL pin is present. </p>
</td></tr>
</table>

</div>
</div>
<a id="ga8838cbe7f55e7f6946f74c100a10a8af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8838cbe7f55e7f6946f74c100a10a8af">&#9670;&nbsp;</a></span>ltc4150_dir_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__drivers__ltc4150.html#ga8838cbe7f55e7f6946f74c100a10a8af">ltc4150_dir_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enumeration of directions in which the charge can be transferred. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="gga8838cbe7f55e7f6946f74c100a10a8afa1ec59ceb1167d2f42dc0c0b0ec188b64"></a>LTC4150_CHARGE&#160;</td><td class="fielddoc"><p>The battery is charged. </p>
</td></tr>
<tr><td class="fieldname"><a id="gga8838cbe7f55e7f6946f74c100a10a8afa6bd7dd6cf179c3075989e7f6bf0e6078"></a>LTC4150_DISCHARGE&#160;</td><td class="fielddoc"><p>Charge is drawn from the battery. </p>
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga7cf0e00f44778e6c55ee87cbeed87998"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7cf0e00f44778e6c55ee87cbeed87998">&#9670;&nbsp;</a></span>ltc4150_avg_current()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ltc4150_avg_current </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__drivers__ltc4150.html#gacea050c124a43ee9deeb487b231381b6">ltc4150_dev_t</a> *&#160;</td>
          <td class="paramname"><em>dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int16_t *&#160;</td>
          <td class="paramname"><em>dest</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the average current drawn in E-01 milliampere. </p>
<p>This will return the average current drawn since boot or last reset until the last pulse from the LTC4150 was received. The value might thus be a bit outdated (0.8 seconds for the breakout board and a current of 100mA, 79 seconds for a current of 1mA).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">dev</td><td>The LTC4150 device to read data from </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dest</td><td>Store the average current drawn in E-01 milliampere here</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success </td></tr>
    <tr><td class="paramname">-EINVAL</td><td>Called with an invalid argument </td></tr>
    <tr><td class="paramname">-EAGAIN</td><td>Called before enough data samples have been acquired. (Wait for at least one second or one pulse from the LTC4150, whichever takes longer.) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga54b4a64e07c4fd49480c7220aaebb311"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga54b4a64e07c4fd49480c7220aaebb311">&#9670;&nbsp;</a></span>ltc4150_charge()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ltc4150_charge </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__drivers__ltc4150.html#gacea050c124a43ee9deeb487b231381b6">ltc4150_dev_t</a> *&#160;</td>
          <td class="paramname"><em>dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>charged</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>discharged</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the measured charge since boot or last reset in millicoulomb. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">dev</td><td>The LTC4150 device to read data from </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">charged</td><td>The charge transferred in charging direction </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">discharged</td><td>The charge transferred in discharging direction</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success </td></tr>
    <tr><td class="paramname">-EINVAL</td><td>Called with an invalid argument</td></tr>
  </table>
  </dd>
</dl>
<p>Passing <code>NULL</code> for <code>charged</code> or <code>discharged</code> is allowed, if only one information is of interest. </p>

</div>
</div>
<a id="ga4fa850f74cbacdf35d41a0a111265d49"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4fa850f74cbacdf35d41a0a111265d49">&#9670;&nbsp;</a></span>ltc4150_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ltc4150_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__drivers__ltc4150.html#gacea050c124a43ee9deeb487b231381b6">ltc4150_dev_t</a> *&#160;</td>
          <td class="paramname"><em>dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structltc4150__params__t.html">ltc4150_params_t</a> *&#160;</td>
          <td class="paramname"><em>params</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the LTC4150 driver. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dev</td><td>Device to initialize </td></tr>
    <tr><td class="paramname">params</td><td>Information on how the LTC4150 is connected</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success </td></tr>
    <tr><td class="paramname">-EINVAL</td><td>Called with invalid argument(s) </td></tr>
    <tr><td class="paramname">-EIO</td><td>IO failure (<code><a class="el" href="group__drivers__periph__gpio.html#gab7d8ecaeb639070a28027a8fd31a0955" title="Initialize the given pin as general purpose input or output.">gpio_init()</a></code>/<code><a class="el" href="group__drivers__periph__gpio.html#ga48ba4c318486db320a4bf6237b49d61c" title="Initialize a GPIO pin for external interrupt usage.">gpio_init_int()</a></code> failed) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga3ad8761da01fd64c8571aa49d58b5264"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3ad8761da01fd64c8571aa49d58b5264">&#9670;&nbsp;</a></span>ltc4150_last_minute_charge()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ltc4150_last_minute_charge </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__drivers__ltc4150.html#gacea050c124a43ee9deeb487b231381b6">ltc4150_dev_t</a> *&#160;</td>
          <td class="paramname"><em>dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structltc4150__last__minute__data__t.html">ltc4150_last_minute_data_t</a> *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>charged</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>discharged</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the measured charge in the last minute. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">dev</td><td>The LTC4150 device to read data from </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">data</td><td>The data recorded by <a class="el" href="group__drivers__ltc4150.html#ga2a4b5144157383f5a4ab76251130ec29">ltc4150_last_minute</a> </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">charged</td><td>The charge transferred in charging direction </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">discharged</td><td>The charge transferred in discharging direction</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success </td></tr>
    <tr><td class="paramname">-EINVAL</td><td>Called with an invalid argument</td></tr>
  </table>
  </dd>
</dl>
<dl class="section warning"><dt>Warning</dt><dd>The returned data may be outdated up to ten seconds</dd></dl>
<p>Passing <code>NULL</code> for <code>charged</code> or <code>discharged</code> is allowed, if only one information is of interest. </p>

</div>
</div>
<a id="gabacb8f10da53a90b9626d036e031d47c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gabacb8f10da53a90b9626d036e031d47c">&#9670;&nbsp;</a></span>ltc4150_pulses2c()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ltc4150_pulses2c </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="group__drivers__ltc4150.html#gacea050c124a43ee9deeb487b231381b6">ltc4150_dev_t</a> *&#160;</td>
          <td class="paramname"><em>dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>charged</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>discharged</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>raw_charged</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>raw_discharged</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert the raw data (# pulses) acquired by the LTC4150 device to charge information in millicoulomb. </p>
<dl class="section note"><dt>Note</dt><dd>This function will make writing data recorders (see <a class="el" href="structltc4150__recorder__t.html">ltc4150_recorder_t</a>) easier, but is not intended for end users</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">dev</td><td>LTC4150 device the data was received from </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">charged</td><td>Charge in charging direction is stored here </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">discharged</td><td>Charge in discharging direction is stored here </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">raw_charged</td><td>Number of pulses in charging direction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">raw_discharged</td><td>Number of pulses in discharging direction </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga1840c34b0f4bd05ffa9279b934189848"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1840c34b0f4bd05ffa9279b934189848">&#9670;&nbsp;</a></span>ltc4150_reset_counters()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ltc4150_reset_counters </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__drivers__ltc4150.html#gacea050c124a43ee9deeb487b231381b6">ltc4150_dev_t</a> *&#160;</td>
          <td class="paramname"><em>dev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Clear current counters of the given LTC4150 device. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dev</td><td>The LTC4150 device to clear current counters from</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success </td></tr>
    <tr><td class="paramname">-EINVAL</td><td>Called with an invalid argument </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga2de1ec4e0b025996428b85484b45b683"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2de1ec4e0b025996428b85484b45b683">&#9670;&nbsp;</a></span>ltc4150_shutdown()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ltc4150_shutdown </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__drivers__ltc4150.html#gacea050c124a43ee9deeb487b231381b6">ltc4150_dev_t</a> *&#160;</td>
          <td class="paramname"><em>dev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Disable the interrupt handler and turn the chip off. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dev</td><td>Previously initialized device to power off</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success </td></tr>
    <tr><td class="paramname">-EINVAL</td><td>Called with invalid argument(s)</td></tr>
  </table>
  </dd>
</dl>
<p>The driver can be reinitialized to power on the LTC4150 chip again </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.12.0-->
<!-- start footer part -->
<div>
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</div>
</body>
</html>
